#include <iostream>
#include <string.h>
using namespace std;

template <class T>
class Stack
{
    private:
     int size;
     int top;
     T *st;
    
    public:
     Stack()
     {
         size=10;
         top=-1;
         st = new T[size];
     }
     
     Stack(int size)
     {
         this->size = size;
         top = -1;
         st = new T[this->size];
     }
     
     void Push(T x);
     T Pop();
     T Peek(int index);
     T StackTop();
     int isFull();
     int isEmpty(); 
     void Display();
     int isOperand(T x);
     int InPrec(T x);
     int OutPrec(T x);
     T *Convert(T * infix);
     
};

template<class T>
void Stack<T>::Push(T x)
{
    if(isFull())
    {
        cout<<"Stack is Full";
    }
    else
    {
        top++;
        st[top] = x;
    }
}

template<class T>
T Stack<T>::Pop()
{
    T x=-1;
    if(isEmpty())
    {
        cout<<"Stack Underflow";
    }
    else
    {
        x = st[top];
        top--;
    }
    return x;
}


template<class T>
T Stack<T>::Peek(int index)
{
    T x = -1;
    if(top - index + 1 < 0)
    {
        cout<<"Invalid Index";
    }
    else
    {
        x=st[top - index + 1];
    }
    return x;
}

template<class T>
T Stack<T>::StackTop()
{
    T x=-1;
    if(isEmpty())
    {
        cout<<"Stack is Empty";
    }
    else
    {
        x= st[top];
    }
    return x;
}

template<class T>
int Stack<T>::isFull()
{
    if(top==size-1)
    {
        return 1;
    }
    else
    {
        return 0;
    }
}

template<class T>
int Stack<T>::isEmpty()
{
    if(top==-1)
    {
        return 1;
    }
    else
    {
        return 0; 
    }
    
}

template<class T>
void Stack<T>::Display()
{
    for(int i = top; i>=0; i--)
    {
        cout<<st[i]<<" ";
    }
    cout<<endl;
}


template<class T>
int Stack<T>::isOperand(T x)
{
    if (x == '+' || x == '-' || x == '*' || x == '/' || x == '(' || x == ')' || x == '^')
      return 0;
    else 
      return 1;
    
}

template<class T>
int Stack<T>::OutPrec(T x)
{
    if (x == '+' || x == '-')
      return 1;
    else if (x == '*' || x == '/') 
      return 3;
    else if (x == '^' ) 
      return 6;
    else if (x == '(') 
      return 7;
    else if (x == ')')
      return 0;
    return 0;
}

template<class T>
int Stack<T>::InPrec(T x)
{
    if (x == '+' || x == '-')
      return 2;
    else if (x == '*' || x == '/') 
      return 4;
    else if (x == '^' ) 
      return 5;
    else if (x == '(') 
      return 0;
    return 0;
}


template<class T>
T* Stack<T>::Convert(T * infix)
{
    T *postfix = new T(30);
    int i=0, j=0;
    
    while(infix[i]!='\0')
    {
        if(isOperand(infix[i]))
        {
            postfix[j++]=infix[i++];
        }
        else
        {
            if(OutPrec(infix[i]) > InPrec(top))
            {
                Push(infix[i++]);
            }
            else if(OutPrec(infix[i]) == InPrec(top))
            {
                Pop();
                i++;
            }
            else
            {
                postfix[j++]=Pop();
            }
        }
    }
    
    while(!isEmpty())
    {
        postfix[j++]=Pop();
    }
    postfix[j]='\0';
    return postfix;
    
    
    
}

int main()
{
    char *infix = "((a+b)*c)-d^e^f";
    Stack<char> s1(40);

    cout<<s1.Convert(infix);
    
}
